for(var numberOfCubes=1,maxCubes=4,topCubes=[maxCubes,maxCubes,maxCubes,maxCubes],midCubes=[maxCubes,maxCubes,maxCubes,maxCubes],botCubes=[maxCubes,maxCubes,maxCubes,maxCubes],multiCubeOffset=0,cubePos="mid",cubeValue=0,cubeNumber=1,xgEmptyId="XGID=--------------------------:0:0:1:00:0:0:0:0:10",xgStartPos="XGID=-b----E-C---eE---c-e----B-:0:0:1:00:0:0:0:0:10",xgNackStartPos="XGID=-bb---D-C---dD---c-d---BB-:0:0:1:00:0:0:0:0:10",xgPos=xgStartPos,defaultTheme=theme1,currentTheme=defaultTheme,borderSize,trayX,ourPoint,savedPos=xgEmptyId,idMessage="",idWarningFlag=!1,idErrorFlag=!1,roll=!0,turn=!0,editMode=!1,recMode=!1,firstRoll=!1,matchInProgress=!1,cubeFlag=!1,twoCubesFlag=!1,diceSwapFlag=!1,swapSidesFlag=!1,snapBackFlag=!1,undoMoveFlag=!1,dragging=!1,checkerTweenActive=!1,drawFlag=!0,animateFlag=!0,badAndroidFlag=!1,checkerSize=60,lineWidth=checkerSize/60,doubleLineWidth=2*lineWidth,trayCheckerCornerRadius=checkerSize/10,cubeLineWidth=checkerSize/5,ourScore=0,oppScore=0,leftDie=0,rightDie=0,highDie=0,lowDie=0,thisLeftDie=0,thisRightDie=0,matchLength=0,cubeStatus=0,nackFlag=0,crawfordFlag=0,jacobyFlag=0,beaverFlag=0,resignFlag=0,moveCount=0,count=0,size=0,gameState=1,oppBoard=new Array(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0),ourBoard=new Array(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0),ourCheckerNameArray=new Array(25),i=0;i<ourCheckerNameArray.length;i++){ourCheckerNameArray[i]=new Array(15);for(var j=0;j<15;j++)ourCheckerNameArray[i][j]=-1}for(var oppCheckerNameArray=new Array(25),i=0;i<oppCheckerNameArray.length;i++){oppCheckerNameArray[i]=new Array(15);for(var j=0;j<15;j++)oppCheckerNameArray[i][j]=-1}for(var ourTrayCheckerArray=[],oppTrayCheckerArray=[],moveListArray=new Array(30),i=0;i<30;i++)moveListArray[i]=new Array(0);var moveArray=[[0,0,"+",-1],[0,0,"+",-1],[0,0,"+",-1],[0,0,"+",-1]];bglogSVG={getPipCount:function(){thisPipCount=0,ourPipCount=0;for(var e=oppPipCount=0;e<25;e++)0<ourBoard[e]&&(ourPipCount+=ourBoard[e]*(e+1)),0<oppBoard[e]&&(oppPipCount+=oppBoard[e]*(e+1));thisPipCount=roll?ourPipCount:oppPipCount},move:function(e,r,o){if(e!=r){var t=24,i=-(r-23);thisBoard=roll?ourBoard:oppBoard;var c=thisBoard;thisToPoint=r,thisFromPoint=e;for(var a=0,n=0,h=24;5<h;h--)a+=ourBoard[h];for(h=24;5<h;h--)n+=oppBoard[h];if(e==t&&undoMoveFlag&&(otherBoard=thisBoard==ourBoard?(thisBoard=oppBoard,ourBoard):(thisBoard=ourBoard,oppBoard),thisToPoint=i),checkers=thisBoard==ourBoard?(otherBoard=oppBoard,checkerNameArray=ourCheckerNameArray,otherCheckerNameArray=oppCheckerNameArray,trayCheckerArray=ourTrayCheckerArray,a):(otherBoard=ourBoard,checkerNameArray=oppCheckerNameArray,otherCheckerNameArray=ourCheckerNameArray,trayCheckerArray=oppTrayCheckerArray,n),e<0&&undoMoveFlag)return checkerName=trayCheckerArray.pop(),0<=r&&(checkerNameArray[r][thisBoard[r]]=checkerName),bglog.pointToXY(r,thisBoard[r],thisBoard),thisBoard[r]+=o,thisFromPoint=-1,moveListArray[checkerName].push(pointX,pointY),bglog.runMoveList(),void(savedPos=xgPos);if(checkerName=checkerNameArray[e][thisBoard[e]-1],null!=checkerName&&-1!=checkerName){if(checkerNameArray[e][thisBoard[e]-1]=-1,0<=r&&(checkerNameArray[r][thisBoard[r]]=checkerName),r<0)0!=checkers&&!editMode||(thisBoard[e]-=o,trayCheckerArray.push(checkerName),bglog.pointToXY(r,0,thisBoard),moveListArray[checkerName].push(pointX,pointY),diceToPlay-=o,pipsToMove-=(e-r)*o,bglog.saveMove(e+1,"o",o,"",checkerName));else{if(bglog.pointToXY(r,thisBoard[r],thisBoard),hit="",thisBoard[e]-=o,thisBoard[r]+=o,moveListArray[checkerName].push(pointX,pointY),diceToPlay-=o,pipsToMove-=(e-r)*o,1==otherBoard[i]){if(otherBoard[i]=0,otherBoard[t]+=1,hit="*",hitChecker=otherCheckerNameArray[i][otherBoard[i]],null==hitChecker||-1==hitChecker)return void console.log("hitChecker "+hitChecker+" not found!!");otherCheckerNameArray[i][otherBoard[i]]=-1,otherCheckerNameArray[t][otherBoard[t]-1]=hitChecker,bglog.pointToXY(t,otherBoard[t]-1,otherBoard),thisToPoint=t,moveListArray[hitChecker].push(pointX,pointY)}bglog.saveMove(e+1,r+1,o,hit,checkerName)}thisBoard=c,0==pipsToMove&&(diceToPlay=0),bglog.runMoveList()}else console.log("checkerName not found!!")}},runMoveList:function(){for(var e=0;e<oppBoard.length;e++){if(0<oppBoard[e])for(j=0;j<oppBoard[e];j++)bglog.generateMove(oppCheckerNameArray[e][j]);if(0<ourBoard[e])for(j=0;j<ourBoard[e];j++)bglog.generateMove(ourCheckerNameArray[e][j])}for(e=0;e<moveListArray.length;e++)bglog.generateMove(e);bglog.updatePipCount(),bglog.boardToXGpos()},generateMove:function(e){var r,o;0<moveListArray[e].length&&(r=moveListArray[e].pop(),o=moveListArray[e].pop(),moveListArray[e]=[],bglog.moveChecker(e,o,r,currentTheme.animateSpeed))},saveMove:function(e,r,o,t,i){undoMoveFlag||(moveArray[moveCount][0]=e,moveArray[moveCount][1]=r,moveArray[moveCount][2]=o,moveArray[moveCount][3]=t,moveArray[moveCount][4]=i,moveCount++)},clearMoveArray:function(){for(var e=0;e<4;e++)moveArray[e][0]=0,moveArray[e][1]=0,moveArray[e][2]=0,moveArray[e][3]="+",moveArray[e][4]=-1},undoMove:function(){if(0<moveCount){undoMoveFlag=!0;for(var e,r=moveCount-1;0<=r;r--){checkerName=moveArray[r][4],thisFromPoint=moveArray[r][1],"o"==thisFromPoint?thisFromPoint=-1:thisFromPoint--,bglog.move(thisFromPoint,moveArray[r][0]-1,moveArray[r][2]),"*"==moveArray[r][3]&&(e=moveArray[r][1]-1,bglog.move(24,-(e-23),1))}bglog.clearMoveArray(),moveCount=0,diceToPlay=2,pipsToMove=leftDie+rightDie,leftDie==rightDie&&(pipsToMove+=pipsToMove,diceToPlay=4),undoMoveFlag=!1}},XYtoPointCount:function(e,r){e<leftX||e>rightX+checkerSize?(oppPoint=ourPoint=-1,thisPoint=-1):e>=leftX+6*checkerSize&&e<=leftX+7*checkerSize?(oppPoint=ourPoint=24,thisPoint=24):ourPoint=r<=middleY?e<leftX+6*checkerSize?-(e-leftX)/checkerSize+24:-((e-=checkerSize)-leftX)/checkerSize+24:e<leftX+6*checkerSize?(e-leftX)/checkerSize:((e-=checkerSize)-leftX)/checkerSize,ourPoint=Math.floor(ourPoint),count=0,r<topY&&e>leftX&&e<rightX+checkerSize&&(count=0),count=r>bottomY&&e>leftX&&e<rightX+checkerSize?0:r<middleY-checkerSize/2?Math.ceil((r-topY)/checkerSize):r>middleY+checkerSize/2?Math.ceil(-(r-topY)/checkerSize+11):6,currentTheme.direction||24==ourPoint||-1==ourPoint||(ourPoint=ourPoint<12?11-ourPoint:35-ourPoint),24==ourPoint?oppPoint=24:-1!=ourPoint&&(oppPoint=-(ourPoint-23));for(var o=0,t=0,i=24;5<i;i--)o+=ourBoard[i];for(i=24;5<i;i--)t+=oppBoard[i];checkerColor=roll?(thisBoard=ourBoard,otherBoard=oppBoard,thisPoint=ourPoint,otherPoint=oppPoint,checkers=o,currentTheme.ourCheckerColor):(thisBoard=oppBoard,otherBoard=ourBoard,thisPoint=oppPoint,otherPoint=ourPoint,checkers=t,currentTheme.oppCheckerColor)},loadXgId:function(e){""!=e&&void 0!==e&&(bglog.xgPosToBoard(e),bglog.xgMatchToBoard(e),bglog.drawCheckers(),bglog.setDice(),bglog.doPointNumbers())},loadgnuId:function(e){var r=e.split(":");gnuPosid=r[0],gnuMatchid=r[1],null!=gnuMatchid&&bglog.matchid2board(gnuMatchid),null!=gnuPosid&&bglog.posid2board(gnuPosid),bglog.drawCheckers(),bglog.setDice(),bglog.doPointNumbers()},swapSides:function(){bglog.swapColors(),bglog.toggleRoll();var e=ourBoard;ourBoard=oppBoard,oppBoard=e;var r=topCubes;topCubes=botCubes,botCubes=r;var o=cubePos;"top"==o&&(cubePos="bot"),"bot"==o&&(cubePos="top"),animateFlag=!1,bglog.doCubes(),bglog.drawCheckers(),bglog.setDice(),animateFlag=!0,swapSidesFlag=!swapSidesFlag},swapColors:function(){var e=currentTheme.ourCheckerColor;currentTheme.ourCheckerColor=currentTheme.oppCheckerColor,currentTheme.ourDiceColour=currentTheme.oppCheckerColor,currentTheme.oppCheckerColor=e,currentTheme.oppDiceColour=e,e=currentTheme.ourDicePipColor,currentTheme.ourDicePipColor=currentTheme.oppDicePipColor,currentTheme.oppDicePipColor=e,e=currentTheme.ourStackingColor,currentTheme.ourStackingColor=currentTheme.oppStackingColor,currentTheme.oppStackingColor=e,$(".ourchecker").attr("fill",currentTheme.ourCheckerColor),$("#ourTurnChecker").attr("fill",currentTheme.ourCheckerColor),$(".ourdice").attr("fill",currentTheme.ourCheckerColor),$(".oppchecker").attr("fill",currentTheme.oppCheckerColor),$("#oppTurnChecker").attr("fill",currentTheme.oppCheckerColor),$(".oppdice").attr("fill",currentTheme.oppCheckerColor)},setDice:function(){var e;0==leftDie&&0==rightDie||!currentTheme.showDice?bglog.hideDice():(e=roll?($(".oppdice").hide(),$(".ourdice").show(),"our"):($(".ourdice").hide(),$(".oppdice").show(),"opp"),bglog.showDice(e+"L",leftDie),bglog.showDice(e+"R",rightDie))},showDice:function(e,r){$("#"+e+"tlPip").hide(),$("#"+e+"trPip").hide(),$("#"+e+"clPip").hide(),$("#"+e+"cPip").hide(),$("#"+e+"crPip").hide(),$("#"+e+"blPip").hide(),$("#"+e+"brPip").hide(),1==r?$("#"+e+"cPip").show():2==r?($("#"+e+"tlPip").show(),$("#"+e+"brPip").show()):3==r?($("#"+e+"trPip").show(),$("#"+e+"cPip").show(),$("#"+e+"blPip").show()):4==r?($("#"+e+"tlPip").show(),$("#"+e+"trPip").show(),$("#"+e+"blPip").show(),$("#"+e+"brPip").show()):5==r?($("#"+e+"tlPip").show(),$("#"+e+"trPip").show(),$("#"+e+"cPip").show(),$("#"+e+"blPip").show(),$("#"+e+"brPip").show()):6==r&&($("#"+e+"tlPip").show(),$("#"+e+"trPip").show(),$("#"+e+"clPip").show(),$("#"+e+"crPip").show(),$("#"+e+"blPip").show(),$("#"+e+"brPip").show())},hideDice:function(){$(".dice").hide()},toggleDirection:function(){currentTheme.direction?currentTheme.direction=!1:currentTheme.direction=!0,animateFlag=!1,bglog.doCubes(),bglog.updateScores();var e=trayX;bglog.updateTrays();for(var r=0;r<30;r++){var o=$("#checker"+r),t=$("#checkerCircle"+r),i=0;o[0]._gsTransform&&(i=o[0]._gsTransform.x),i==e&&i!=trayX&&(TweenLite.set(o,{x:trayX}),TweenLite.set(t,{attr:{height:trayCheckerHeight,rx:trayCheckerCornerRadius}}))}animateFlag=!0},toggleRoll:function(){roll=!roll,bglog.setDice(),bglog.updateScores(),bglog.boardToXGpos(),bglog.doPointNumbers(),savedPos=xgPos},updateTrays:function(){trayX=rightX+checkerSize+borderWidth,currentTheme.direction&&(trayX=leftX-checkerSize-borderWidth)},toggleStacking:function(){currentTheme.stacking?currentTheme.stacking=!1:currentTheme.stacking=!0,bglog.drawCheckers()},toggleShowNumbers:function(){currentTheme.showPointNumbers?currentTheme.showPointNumbers=!1:currentTheme.showPointNumbers=!0,bglog.doPointNumbers()},togglecpStyle:function(){currentTheme.cpStyle?currentTheme.cpStyle=!1:currentTheme.cpStyle=!0,bglog.doPointNumbers()},toggletakiPoints:function(){currentTheme.takiPoints?currentTheme.takiPoints=!1:currentTheme.takiPoints=!0,$(".takiPoint").hide(),$(".nonTakiPoint").hide(),currentTheme.takiPoints?$(".takiPoint").show():$(".nonTakiPoint").show()},togglePipCount:function(){currentTheme.showPipCount?currentTheme.showPipCount=!1:currentTheme.showPipCount=!0,bglog.updatePipCount()},toggleCube:function(){currentTheme.showCube?currentTheme.showCube=!1:currentTheme.showCube=!0},toggleIDs:function(){currentTheme.showIDs?currentTheme.showIDs=!1:currentTheme.showIDs=!0},toggleEdit:function(){editMode=!editMode},toggleDice:function(){currentTheme.showDice?currentTheme.showDice=!1:currentTheme.showDice=!0,currentTheme.showDice?bglog.setDice():bglog.hideDice()},toggleScore:function(){currentTheme.showScore?currentTheme.showScore=!1:currentTheme.showScore=!0,currentTheme.showScore&&0!=matchLength?($("#ourScoreText").show(),$("#oppScoreText").show()):($("#ourScoreText").hide(),$("#oppScoreText").hide())},toggleTurnIndicator:function(){currentTheme.showTurnIndicator?currentTheme.showTurnIndicator=!1:currentTheme.showTurnIndicator=!0,currentTheme.direction?($("#ourScoreText").attr("x",leftX-borderWidth-checkerSize/2),$("#oppScoreText").attr("x",leftX-borderWidth-checkerSize/2)):($("#ourScoreText").attr("x",rightX+checkerSize+borderWidth+checkerSize/2),$("#oppScoreText").attr("x",rightX+checkerSize+borderWidth+checkerSize/2)),currentTheme.showTurnIndicator?roll?($("#oppTurnChecker").hide(),$("#ourTurnChecker").show()):($("#oppTurnChecker").show(),$("#ourTurnChecker").hide()):($("#ourTurnChecker").hide(),$("#oppTurnChecker").hide()),bglog.updateScores()},toggleAwayStyle:function(){currentTheme.awayStyle?currentTheme.awayStyle=!1:currentTheme.awayStyle=!0,bglog.updateScores()},toggleCubeStart:function(){currentTheme.cubeStart?currentTheme.cubeStart=!1:currentTheme.cubeStart=!0,bglog.doCubes()},setAnimationSpeed:function(e){currentTheme.animateSpeed=e},moveCube:function(e,r,o){var t=e-1,i=r,c=$("#cube"+t+"Text"),a=o,n=+checkerSize+ +borderWidth+(size-cubeWidth)/2,h=5*checkerSize+borderWidth+pipCountFontSize+(size-cubeWidth)/2;if($("#cube"+t).css("visibility","visible"),"off"!=r)if("on"!=r){currentTheme.cubeStart&&"mid"==i&&0==a&&(a=6);var u=Math.pow(2,a);if(c.text(u+""),1==crawfordFlag&&c.text("C"),0!=t||"ourside"!=i&&"oppside"!=i){for(var l=0;l<maxCubes;l++)topCubes[l]==t&&(topCubes[l]=maxCubes),midCubes[l]==t&&(midCubes[l]=maxCubes),botCubes[l]==t&&(botCubes[l]=maxCubes);if(0==t&&(cubePos=i,cubeValue=o),"top"==i)for(l=0;l<maxCubes;l++)if(topCubes[l]==maxCubes){topCubes[l]=t;break}if("mid"==i)for(l=0;l<maxCubes;l++)if(midCubes[l]==maxCubes){midCubes[l]=t;break}if("bot"==i)for(l=0;l<maxCubes;l++)if(botCubes[l]==maxCubes){botCubes[l]=t;break}topCubes.sort(),midCubes.sort(),botCubes.sort(),bglog.doCubes()}else n=leftX+6*checkerSize+cubeLineWidth/2,h=topY+5*checkerSize+cubeLineWidth/2,currentTheme.direction?n-=3.5*checkerSize:n+=3.5*checkerSize,"ourside"==i&&(h+=3*checkerSize),"oppside"==i&&(h-=3*checkerSize),bglog.animateCube(t,n,h)}else $("#cube"+t).css("visibility","visible");else $("#cube"+t).css("visibility","hidden")},showCubes:function(){if(currentTheme.showCube)for(var e=0;e<maxCubes;e++)numberOfCubes<=e?allCubeGroups[e].hide():allCubeGroups[e].show();else allCubeGroups.hide();bglog.drawLayer(movingLayer)},animateCube:function(e,r,o){var t;drawFlag&&(t=currentTheme.animateSpeed,animateFlag||(t=0),bglog.moveToTop($("#cube"+e)),TweenLite.to($("#cube"+e),2*t,{x:r,y:o,ease:Power4.easeInOut}))},doCubes:function(){var e=cubeLineWidth/2;1==numberOfCubes||2==numberOfCubes&&twoCubesFlag?cubeX=leftX+6*checkerSize+e-doubleLineWidth:(cubeX=e,currentTheme.direction||(cubeX=2.5*checkerSize+rightX));for(var r=0,o=0;o<maxCubes;o++)midCubes[o]<maxCubes&&r++;for(o=0;o<maxCubes;o++)topCubes[o]<maxCubes&&0;for(o=0;o<maxCubes;o++)botCubes[o]<maxCubes&&0;for(o=0;o<maxCubes;o++){var t=topY+doubleLineWidth;topCubes[o]<maxCubes&&bglog.animateCube(topCubes[o],cubeX,t+checkerSize*o);t=topY-lineWidth+e+5*checkerSize;1<r&&(t-=checkerSize/2*(r-1)),midCubes[o]<maxCubes&&bglog.animateCube(midCubes[o],cubeX,t+checkerSize*o);t=topY+doubleLineWidth+e+10*checkerSize;botCubes[o]<maxCubes&&bglog.animateCube(botCubes[o],cubeX,t-checkerSize*o)}},drawCheckers:function(){for(var e=0,r=0,o=0;o<25;o++)e+=ourBoard[o],r+=oppBoard[o];for(o=0;o<25;o++)bglog.generateMoveList("rem",o,ourBoard[o],ourBoard,e),bglog.generateMoveList("rem",o,oppBoard[o],oppBoard,r);for(o=0;o<25;o++)bglog.generateMoveList("add",o,ourBoard[o],ourBoard,e),bglog.generateMoveList("add",o,oppBoard[o],oppBoard,r);bglog.runMoveList()},generateMoveList:function(e,r,o,t,i){var c=e,a=r,n=o,h=t,u=i,l=ourCheckerNameArray,s=ourTrayCheckerArray;h==oppBoard&&(l=oppCheckerNameArray,s=oppTrayCheckerArray);for(var d=0,p=-1,g=0;g<15&&-1!=l[a][g];g++)d++,p=l[a][g];if(15<u-h[a]+n&&(n=15-(u-h[a])),n<6){if(n<d&&"rem"==c)for(g=d-n;0<g;g--)d--,p=l[a][d],l[a][d]=-1,s.push(p),thisFromPoint=a,bglog.pointToXY(-1,0,h),moveListArray[p].push(pointX,pointY);else if(d<n&&"add"==c){n-=d;for(g=0;g<n;g++){if(0==s.length)return void console.log("trayCheckerArray error, move ignored.");p=s.pop(),l[a][d]=p,thisFromPoint=-1,bglog.pointToXY(a,d++,h),moveListArray[p].push(pointX,pointY)}}}else if("add"==c){15<n-d&&(n=15-u);for(var b=n-d,g=0;g<b;g++){if(0==s.length)return void console.log("trayCheckerArray error, move ignored.");p=s.pop(),l[a][d]=p,thisFromPoint=-1,bglog.pointToXY(a,d++,h),moveListArray[p].push(pointX,pointY)}}},moveToTop:function(e){var r=e[0];r.ownerSVGElement.appendChild(r)},moveChecker:function(e,r,o,t){var i;-1!=e?(firstRoll=!1,thisMovingChecker=$("#checker"+e),thisMovingChecker.attr("id"),currX=currY=0,thisMovingChecker[0]._gsTransform&&(currX=thisMovingChecker[0]._gsTransform.x,currY=thisMovingChecker[0]._gsTransform.y),thisMovingChecker.show(),$("#checkerText"+e).text(""),i=$("#checkerCircle"+e),animateFlag||(t=.01),checkerTweenActive=!0,checkerTween=TweenLite.to(thisMovingChecker,t,{paused:!0,overwrite:!0,x:r,y:o,ease:Power2.easeInOut,onStart:bglog.moveToTop(thisMovingChecker),onComplete:bglog.tweenComplete}),snapBackFlag||dragging||(currX==trayX&&TweenLite.to(i,t/2,{attr:{height:checkerHeight,rx:checkerSize},ease:Linear.easeNone,delay:t/4}),r==trayX?TweenLite.to(i,t/3,{attr:{height:trayCheckerHeight,rx:trayCheckerCornerRadius},ease:Linear.easeNone,delay:t/2}):TweenLite.to(i,t/2,{overwrite:"all",attr:{height:checkerHeight,rx:checkerSize},ease:Linear.easeNone})),bglog.restack(),checkerTween.play()):console.log("checkerName -1 ignored")},tweenComplete:function(){snapBackFlag=checkerTweenActive=!1,thisMovingChecker=this.target;var e=thisMovingChecker.attr("id");checkerName=parseInt(e.substring(7)),bglog.restack(),bglog.moveToTop($("#touch"))},restack:function(){currentTheme.stacking||(bglog.restackBoard(ourBoard,ourCheckerNameArray),bglog.restackBoard(oppBoard,oppCheckerNameArray))},restackBoard:function(e,r){for(var o=0;o<e.length;o++)if(4<e[o]){var t=$("#checkerText"+r[o][4]);if(5<e[o]){for(var i=e[o]-5;0<i;i--){var c=r[o][i+4];$("#checker"+c).hide()}t.text(e[o])}else t.text("")}},pointToXY:function(e,r,o){if(savePoint=e,savePos=r,24==e){var t=topY+lineWidth/2+4*checkerSize,i=bottomY-lineWidth/2-5*checkerSize;maxOnPoint=4,pointX=leftX+6*checkerSize,pointX=Math.round(pointX);var c=i;o==ourBoard&&(c=t);for(var a=maxOnPoint,n=c,h=0;h<=r;h++){pointY=c==t?n-checkerSize*r:n+checkerSize*r,0==a--&&(maxOnPoint--,0<maxOnPoint?(a=maxOnPoint-1,d=maxOnPoint*checkerSize+checkerSize/2,c==t?(pointY+=d,n+=d):(pointY-=d,n-=d)):(a=0,pointY=saveY))}return pointY=Math.round(pointY),void(saveY=pointY)}var u;if(e<0)return pointX=trayX,void(o==ourBoard?(u=ourTrayCheckerArray.length-1,pointY=bottomY-doubleLineWidth-trayCheckerHeight*(u+1),pointY+=lineWidth/2,2<u&&(pointY-=3*lineWidth),5<u&&(pointY-=3*lineWidth),8<u&&(pointY-=3*lineWidth),11<u&&(pointY-=3*lineWidth)):(u=oppTrayCheckerArray.length-1,pointY=topY-trayCheckerHeight+lineWidth+trayCheckerHeight*(u+1),pointY+=lineWidth/2,2<u&&(pointY+=3*lineWidth),5<u&&(pointY+=3*lineWidth),8<u&&(pointY+=3*lineWidth),11<u&&(pointY+=3*lineWidth)));var l=-(savePoint-23),t=topY+doubleLineWidth,c=bottomY-checkerSize,s=rightX;currentTheme.direction&&(s=leftX),o==ourBoard&&(c=t),savePoint<12&&(l=-(savePoint-11),c=c==t?bottomY-lineWidth/2-checkerSize:t,s=s==leftX?rightX:leftX),s==rightX?(pointX=s-checkerSize*l,5<l&&(pointX-=checkerSize)):(pointX=s+checkerSize*l,5<l&&(pointX+=checkerSize)),pointY=c,maxOnPoint=5;for(a=maxOnPoint-1,n=c,h=0;h<r;h++){var d,p=c==t?(pointY=n+checkerSize*r,n+checkerSize*(maxOnPoint-1)):(pointY=n-checkerSize*r,n-checkerSize*(maxOnPoint-1));r+1>maxOnPoint&&!currentTheme.stacking?pointY=p:0==a--&&(maxOnPoint--,0<maxOnPoint?(a=maxOnPoint-1,d=maxOnPoint*checkerSize+checkerSize/2,c==t?(pointY-=d,n-=d):(pointY+=d,n+=d)):(a=0,pointY=saveY))}pointX=Math.round(pointX),pointY=Math.round(pointY),saveY=pointY},updatePipCount:function(){bglog.getPipCount(),$("#ourPipcount").text(ourPipCount),$("#oppPipcount").text(oppPipCount),currentTheme.showPipCount?($("#ourPipcount").show(),$("#oppPipcount").show()):($("#ourPipcount").hide(),$("#oppPipcount").hide())},doPointNumbers:function(){$(".pointNumbers").hide(),currentTheme.showPointNumbers&&(currentTheme.direction?currentTheme.cpStyle?($("#top1to12").show(),$("#mid24to13").show(),$("#bot1to12").show()):roll?($("#top24to13").show(),$("#bot1to12").show()):($("#top1to12").show(),$("#bot24to13").show()):currentTheme.cpStyle?($("#top12to1").show(),$("#mid13to24").show(),$("#bot12to1").show()):roll?($("#top13to24").show(),$("#bot12to1").show()):($("#top12to1").show(),$("#bot13to24").show()))},xgPosToBoard:function(e){var r="-abcdefghijklmnoABCDEFGHIJKLMNO",o=0;e=e.split("=").pop();for(var t=1;t<=24;t++)15<(o=r.indexOf(e[t]))&&(o=0),oppBoard[-(t-24)]=o;15<(o=r.indexOf(e[0]))&&(o=0),oppBoard[24]=o;for(t=1;t<=24;t++)(o=r.indexOf(e[t]))<=15?o=0:o-=15,ourBoard[t-1]=o;(o=r.indexOf(e[25]))<=15?o=0:o-=15,ourBoard[24]=o},xgMatchToBoard:function(e){e=e.split("=").pop(),e+=":";for(var r=27,o="";":"!=e[r];)o+=e[r++];r++,cubeValue=parseInt(o);for(var t="";":"!=e[r];)t+=e[r++];r++,t=parseInt(t),cubePos=-1==t?"top":1==t?"bot":"mid";for(var i="";":"!=e[r];)i+=e[r++];for(r++,i=parseInt(i),turn=roll=-1!=i,cubeFlag=!1,leftDie=rightDie=cubeStatus=0;":"!=e[r];)"D"==(thisLeftDie=e[r++])||"B"==thisLeftDie||"R"==thisLeftDie?(cubeFlag=!0,cubeStatus=1,roll?bglog.moveCube(cubeNumber,"oppside",cubeValue+1):bglog.moveCube(cubeNumber,"ourside",cubeValue+1)):thisRightDie=e[r++],1==cubeStatus?turn=!roll:("-"!=thisLeftDie&&(leftDie=parseInt(thisLeftDie)),"-"!=thisRightDie&&(rightDie=parseInt(thisRightDie)));r++,diceToPlay=2,pipsToMove=leftDie+rightDie,leftDie==rightDie&&(pipsToMove+=pipsToMove,diceToPlay=4),bglog.clearMoveArray(),moveCount=0;for(var c="";":"!=e[r];)c+=e[r++];r++,ourScore=parseInt(c);for(var a="";":"!=e[r];)a+=e[r++];r++,oppScore=parseInt(a),xgCrawford=parseInt(e[r++]),r++;for(var n="";":"!=e[r];)n+=e[r++];r++,matchLength=parseInt(n),thisLabel=0==matchLength?"money":"match",bglog.updateScores(),crawfordFlag=0,"match"==thisLabel?crawfordFlag=1==xgCrawford?1:0:(0==xgCrawford&&(beaverFlag=jacobyFlag=0),1==xgCrawford&&(jacobyFlag=1,beaverFlag=0),2==xgCrawford&&(jacobyFlag=0,beaverFlag=1),3==xgCrawford&&(beaverFlag=jacobyFlag=1));for(var h="";":"!=e[r];)h+=e[r++];maxCube=parseInt(h),cubeFlag||bglog.moveCube(1,cubePos,cubeValue)},updateScores:function(){currentTheme.awayStyle?($("#oppScoreText").text("–"+(matchLength-oppScore)),$("#ourScoreText").text("–"+(matchLength-ourScore))):($("#oppScoreText").text(oppScore+"/"+matchLength),$("#ourScoreText").text(ourScore+"/"+matchLength)),currentTheme.showScore?currentTheme.showScore=!1:currentTheme.showScore=!0,bglog.toggleScore(),$("#ourScoreText").attr("fill",currentTheme.textColor),$("#oppScoreText").attr("fill",currentTheme.textColor),currentTheme.showTurnIndicator&&(currentTheme.direction?($("#ourScoreText").attr("x",rightX+checkerSize+borderWidth+checkerSize/2),$("#oppScoreText").attr("x",rightX+checkerSize+borderWidth+checkerSize/2),$("#ourTurnChecker").attr("cx",leftX-checkerSize-borderWidth+checkerSize/2),$("#oppTurnChecker").attr("cx",leftX-checkerSize-borderWidth+checkerSize/2)):($("#ourScoreText").attr("x",leftX-borderWidth-checkerSize/2),$("#oppScoreText").attr("x",leftX-borderWidth-checkerSize/2),$("#ourTurnChecker").attr("cx",rightX+checkerSize+borderWidth+checkerSize/2),$("#oppTurnChecker").attr("cx",rightX+checkerSize+borderWidth+checkerSize/2))),roll?currentTheme.showTurnIndicator?($("#oppTurnChecker").hide(),$("#ourTurnChecker").show()):$("#ourScoreText").attr("fill",currentTheme.highlightColor):currentTheme.showTurnIndicator?($("#oppTurnChecker").show(),$("#ourTurnChecker").hide()):$("#oppScoreText").attr("fill",currentTheme.highlightColor)},loadTheme:function(theme){currentTheme=eval(theme);var checkerWidth=checkerSize-doubleLineWidth;$(".takiPoint").hide(),$(".nonTakiPoint").hide(),currentTheme.takiPoints?$(".takiPoint").show():$(".nonTakiPoint").show(),$("#canvas").attr("fill",currentTheme.canvasColor),$("#border").attr("fill",currentTheme.borderColor),$(".surface").attr("fill",currentTheme.surfaceColor),$(".tray").attr("fill",currentTheme.trayColor),$("#bar").attr("fill",currentTheme.barColor),$(".pointA").attr("fill",currentTheme.pointBcolor),$(".pointA").attr("stroke",currentTheme.pointOutlines),$(".pointA").css("strokeWidth",lineWidth),$(".pointB").attr("fill",currentTheme.pointAcolor),$(".pointB").attr("stroke",currentTheme.pointOutlines),$(".pointB").css("strokeWidth",lineWidth),$(".pointNumbers").attr("fill",currentTheme.textColor),$(".pointNumbers").css("textShadow","none"),$("#oppPipcount").attr("fill",currentTheme.pipcountTextColor),$("#oppPipcount").css("textShadow","none"),$("#ourPipcount").attr("fill",currentTheme.pipcountTextColor),$("#ourPipcount").css("textShadow","none"),$(".ourchecker").attr("width",checkerWidth),$(".ourchecker").attr("fill",currentTheme.ourCheckerColor),$(".ourchecker").attr("stroke","#000"),$(".ourchecker").css("strokeWidth",lineWidth),$(".ourcheckertext").attr("fill",currentTheme.ourStackingColor),$("#ourTurnChecker").attr("fill",currentTheme.ourCheckerColor),$("#ourTurnChecker").attr("stroke","#000"),$("#ourTurnChecker").attr("r",checkerWidth/5),$(".oppchecker").attr("width",checkerWidth),$(".oppchecker").attr("fill",currentTheme.oppCheckerColor),$(".oppchecker").attr("stroke","#000"),$(".oppchecker").css("strokeWidth",lineWidth),$(".oppcheckertext").attr("fill",currentTheme.oppStackingColor),$("#oppTurnChecker").attr("fill",currentTheme.oppCheckerColor),$("#oppTurnChecker").attr("stroke","#000"),$("#oppTurnChecker").attr("r",checkerWidth/5),$(".cubes").attr("fill",currentTheme.cubeColor),$(".cubes").attr("stroke",currentTheme.pointOutlines),$(".cubes").css("strokeWidth",doubleLineWidth),$(".cubeText").attr("fill",currentTheme.cubeTextColor),$(".cubeText").attr("stroke","none"),$(".cubeText").css("fontSize",cubeFontSize),$(".cubeText").css("textShadow","none"),$("#cube0").css("visibility","visible"),$(".ourdice").attr("fill",currentTheme.ourCheckerColor),$(".ourDicePips").attr("fill",currentTheme.ourDicePipColor),$(".ourDicePips").attr("r",dicePipRadius),$(".oppdice").attr("fill",currentTheme.oppCheckerColor),$(".oppDicePips").attr("fill",currentTheme.oppDicePipColor),$(".oppDicePips").attr("r",dicePipRadius),currentTheme.direction?currentTheme.direction=!1:currentTheme.direction=!0,bglog.toggleDirection()},initCheckers:function(){for(var e=0;e<15;e++)ourTrayCheckerArray.push(e);for(e=15;e<30;e++)oppTrayCheckerArray.push(e);for(e=0;e<30;e++){var r=$("#checker"+e),o=$("#checkerCircle"+e);TweenLite.set(r,{x:trayX,y:middleY}),TweenLite.set(o,{attr:{height:checkerHeight,rx:checkerSize}})}},base64_decode:function(e){var r,o,t,i,c,a,n="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",h=0,u=0,l=[];if(!e)return e;for(e+="";r=(a=n.indexOf(e.charAt(h++))<<18|n.indexOf(e.charAt(h++))<<12|(i=n.indexOf(e.charAt(h++)))<<6|(c=n.indexOf(e.charAt(h++))))>>16&255,o=a>>8&255,t=255&a,l[u++]=64==i?String.fromCharCode(r):64==c?String.fromCharCode(r,o):String.fromCharCode(r,o,t),h<e.length;);return l.join("")},hexdec:function(e){return e=(e+"").replace(/[^a-f0-9]/gi,""),parseInt(e,16)},bin2hex:function(e){for(var r,o="",t=0,i=(e+="").length;t<i;t++)o+=(r=e.charCodeAt(t).toString(16)).length<2?"0"+r:r;return o},boardToXGpos:function(){var e="-abcdefghijklmnoABCDEFGHIJKLMNO";xgPos="XGID=",0!=oppBoard[24]?xgPos+=e[oppBoard[24]+0]:xgPos+="-";for(var r=0;r<24;r++)0!=ourBoard[r+0]?xgPos+=e[ourBoard[r]+15]:0!=oppBoard[-(r-23)]?xgPos+=e[oppBoard[-(r-23)]+0]:xgPos+="-";0!=ourBoard[24]?xgPos+=e[ourBoard[r]+15]:xgPos+="-";var o="bot"==cubePos?1:"top"==cubePos?-1:0,t=roll?1:-1;thisLabel=0==matchLength?(xgCrawfordFlag=jacobyFlag+2*beaverFlag,"money"):(xgCrawfordFlag=crawfordFlag,"match"),bglog.updateScores();var i=leftDie,c=rightDie;cubeFlag&&(i="D",c=""),"-"==thisLeftDie&&(i=thisLeftDie),"-"==thisRightDie&&(c=thisRightDie),xgPos+=":"+cubeValue+":"+o+":"+t+":"+i+c+":",xgPos+=ourScore+":"+oppScore+":"+xgCrawfordFlag+":"+matchLength+":"+maxCube},matchid2board:function(e){idErrorFlag=idWarningFlag=!1;for(var r=idMessage="",o="",t=bglog.base64_decode(e),i=0;i<9;i++)r+=sprintf("%08b",bglog.hexdec(bglog.bin2hex(t[i])));for(i=0;i<9;i++)for(var c=7;0<=c;c--)o+=r[8*i+c];i=66,gnuJacoby=bglog.bindec(o[i]),jacobyFlag=0==gnuJacoby?1:0,i--,char="";for(c=0;c<15;c++)char+=o[i],i--;98<(ourScore=bglog.bindec(char))&&(idMessage="Warning: bottom player score reset from "+ourScore+" to 98.",ourScore=98,idWarningFlag=!0),char="";for(c=0;c<15;c++)char+=o[i],i--;98<(oppScore=bglog.bindec(char))&&(idMessage="Warning: top player score reset from "+oppScore+" to 98.",oppScore=98,idWarningFlag=!0),char="";for(c=0;c<15;c++)char+=o[i],i--;if(99<(matchLength=bglog.bindec(char))&&(idMessage="Warning: match length reset from "+matchLength+" to 99.",matchLength=99,idWarningFlag=!0),0<matchLength){if(matchLength-1<ourScore)return idMessage="Bottom player score invalid - must be less than match length.",!(idErrorFlag=!0);if(matchLength-1<oppScore)return idMessage="Top player score invalid - must be less than match length.",!(idErrorFlag=!0)}bglog.updateScores(),thisLabel=0==matchLength?"money":"match",char="";for(c=0;c<3;c++)char+=o[i],i--;if(6<(rightDie=bglog.bindec(char)))return idMessage="Error: right die "+rightDie+", should be 0-6.",!(idErrorFlag=!(rightDie=0));char="";for(c=0;c<3;c++)char+=o[i],i--;if(6<(leftDie=bglog.bindec(char)))return idMessage="Error: left die "+leftDie+", should be 0-6.",!(idErrorFlag=!(leftDie=0));char="";for(c=0;c<2;c++)char+=o[i],i--;res=bglog.bindec(char),cubeStatus=bglog.bindec(o[i]),cubeFlag=0!=cubeStatus?!0:!1,i--,gnuTurn=bglog.bindec(o[i]),turn=!0,0==gnuTurn&&(turn=!1),i--,char="";for(c=0;c<3;c++)char+=o[i],i--;if(4<(gameState=bglog.bindec(char)))return idMessage="Error: invalid game state "+gameState+", should be 0-4.",!(idErrorFlag=!(gameState=0));if(crawfordFlag=bglog.bindec(o[i]),i--,0!=crawfordFlag&&1!=crawfordFlag)return idMessage="Crawford flag must be 0 or 1.",!(idErrorFlag=!0);if(1==crawfordFlag&&ourScore!=matchLength-1&&oppScore!=matchLength-1)return idMessage="Crawford flag invalid at this score.",!(idErrorFlag=!0);gnuRoll=bglog.bindec(o[i]),roll=!0,0==gnuRoll&&(roll=!1),i--,char="";for(c=0;c<2;c++)char+=o[i],i--;var a=bglog.bindec(char);if(0==a)cubePos="top";else if(1==a)cubePos="bot";else{if(3!=a)return idMessage="Error: invalid cube owner "+a,idErrorFlag=!0,!(a=3);cubePos="mid"}char="";for(var n,c=0;c<4;c++)char+=o[i],i--;return 6<(cubeValue=bglog.bindec(char))&&(n=Math.pow(2,cubeValue),idMessage="Warning: cube value "+n+" reduced to 64.",cubeValue=6,idWarningFlag=!0),cubeFlag?roll?bglog.moveCube(cubeNumber,"oppside",cubeValue+1):bglog.moveCube(cubeNumber,"ourside",cubeValue+1):bglog.moveCube(cubeNumber,cubePos,cubeValue),!0},posid2board:function(e){for(var r="",o="",t=[],i=bglog.base64_decode(e),c=0;c<10;c++)r+=sprintf("%08b",bglog.hexdec(bglog.bin2hex(i[c])));for(c=0;c<10;c++)for(var a=7;0<=a;a--)o+=r[8*c+a];for(var n=0,a=0,h=0,u=[],l=[],c=0;c<80;c++){for(;1==o[c];)h++,n++,c++;t[a++]=parseInt(sprintf("%2d",n)),n=0}if(30<h)return idMessage="Error: too many checkers!",!(idErrorFlag=!0);for(c=0;c<25;c++)roll?(l[c]=t[c],u[c]=t[c+25]):(l[c]=t[c+25],u[c]=t[c]);for(var s=0,d=0,c=0;c<25;c++)s+=u[c],d+=l[c];if(15<s||15<d)return idMessage="Error: too many checkers!",!(idErrorFlag=!0);for(c=0;c<24;c++)if(0!=u[c]&&0!=l[23-c])return idMessage="Error: illegal checker placement!",!(idErrorFlag=!0);return ourBoard=u,oppBoard=l,!0},bindec:function(e){return e=(e+"").replace(/[^01]/gi,""),parseInt(e,2)},makeBoard:function(e){null==e&&(e=60);rightDie=leftDie=0;borderWidth=2,pipCountFontSize=e/2,pointNumberFontSize=e/12*5;var r=17*e+4*borderWidth,o=11*e+2*borderWidth+2*pipCountFontSize,t=15*e+4*borderWidth,i=11*e+2*borderWidth;cubeWidth=e/6*5;var c=cubeFontSize=e/6*4;dicePipRadius=e/12,startX=2*e+2*borderWidth+doubleLineWidth,startY=pipCountFontSize+borderWidth+doubleLineWidth,endX=startX+e-4*lineWidth;var a=startX+e/2-doubleLineWidth,n=startY+5*e,h=startY+e/2,u="pointA";leftX=2*e+2*borderWidth+lineWidth,rightX=leftX+12*e,middleX=leftX+6*e,topY=borderWidth+pipCountFontSize,bottomY=topY+11*e,middleY=topY+5*e+e/2,trayX=rightX+e+borderWidth,currentTheme.direction&&(trayX=leftX-e-borderWidth),trayCheckerHeight=e/3-lineWidth,checkerHeight=checkerSize-doubleLineWidth,maxCube=10;for(var l="ourchecker",s=8*e+2*borderWidth+(e-cubeWidth)/2,d=5*e+borderWidth+pipCountFontSize+(e-cubeWidth)/2,p=cubeWidth/7,g=4*e+2*borderWidth+(e-c)/2,b=5*e+borderWidth+pipCountFontSize+(e-c)/2,m="<svg id='svgboard' version='1.1' xmlns='http://www.w3.org/2000/svg' viewbox='0 0 "+r+" "+o+"' style='position: absolute; height: 100%; width: 100%; left: 0; top: 0;' ><rect id='canvas' x='0' y='0' width='"+r+"' height='"+o+"'></rect><rect id='border' x='"+e+"' y='"+pipCountFontSize+"' width='"+t+"' height='"+i+"'></rect><rect id='toplefttray' class='tray' x='"+(e+borderWidth)+"' y='"+(pipCountFontSize+borderWidth)+"' width='"+e+"' height='"+5*e+"'></rect><rect id='botlefttray' class='tray' x='"+(e+borderWidth)+"' y='"+(pipCountFontSize+borderWidth+6*e)+"' width='"+e+"' height='"+5*e+"'></rect><rect id='leftsurface' class='surface' x='"+(2*e+2*borderWidth)+"' y='"+(pipCountFontSize+borderWidth)+"' width='"+6*e+"' height='"+11*e+"'></rect><rect id='bar' x='"+(8*e+3*borderWidth)+"' y='"+(pipCountFontSize+borderWidth)+"' width='"+(e-2*borderWidth)+"' height='"+11*e+"'></rect><rect id='rightsurface' class='surface' x='"+(9*e+2*borderWidth)+"' y='"+(pipCountFontSize+borderWidth)+"' width='"+6*e+"' height='"+11*e+"'></rect><rect id='toprighttray' class='tray' x='"+(15*e+3*borderWidth)+"' y='"+(pipCountFontSize+borderWidth)+"' width='"+e+"' height='"+5*e+"'></rect><rect id='botrighttray' class='tray' x='"+(15*e+3*borderWidth)+"' y='"+(pipCountFontSize+borderWidth+6*e)+"' width='"+e+"' height='"+5*e+"'></rect>",f=pipCountFontSize+borderWidth+doubleLineWidth-e/6,C=0,k=0;k<24;k++)6==C&&C++,12==k&&(C=0,startY=pipCountFontSize+borderWidth-doubleLineWidth+11*e,f+=11.5*e-4*lineWidth-e/6,n=startY-5*e,h=startY-e/2,u="pointB"),m+="<path d='M"+(startX+e*C)+" "+h+" C"+(startX+e*C)+" "+f+" "+(endX+e*C)+" "+f+" "+(endX+e*C)+" "+h+" L"+(a+e*C)+" "+n+"z' class='takiPoint "+u+"'></path>",m+="<path d='M"+(startX+e*C)+" "+startY+" L"+(endX+e*C)+" "+startY+" "+(a+e*C)+" "+n+"z' class='nonTakiPoint "+u+"'></path>",u="pointA"==u?"pointB":"pointA",C++;var x=2*e+e/2+2*borderWidth,T=pipCountFontSize-3*doubleLineWidth;m+="<g id='top1to12' class='pointNumbers' font-size='"+pointNumberFontSize+"' text-anchor='middle' font-family='arial' fill='black'>";for(var y=x,k=1;k<=12;k++)m+="<text x='"+y+"' y='"+T+"'>"+k+"</text>",6==k&&(y+=e),y+=e;m+="</g>",m+="<g id='top13to24' class='pointNumbers' font-size='"+pointNumberFontSize+"' text-anchor='middle' font-family='arial' fill='black'>";for(y=x,k=13;k<=24;k++)m+="<text x='"+y+"' y='"+T+"'>"+k+"</text>",18==k&&(y+=e),y+=e;m+="</g>",m+="<g id='top12to1' class='pointNumbers' font-size='"+pointNumberFontSize+"' text-anchor='middle' font-family='arial' fill='black'>";for(y=x,k=12;1<=k;k--)m+="<text x='"+y+"' y='"+T+"'>"+k+"</text>",7==k&&(y+=e),y+=e;m+="</g>",m+="<g id='top24to13' class='pointNumbers' font-size='"+pointNumberFontSize+"' text-anchor='middle' font-family='arial' fill='black'>";for(y=x,k=24;13<=k;k--)m+="<text x='"+y+"' y='"+T+"'>"+k+"</text>",19==k&&(y+=e),y+=e;m+="</g>",T=n-e/3,m+="<g id='mid1to12' class='pointNumbers' font-size='"+pointNumberFontSize+"' text-anchor='middle' font-family='arial' fill='black'>";for(y=x,k=1;k<=12;k++)m+="<text x='"+y+"' y='"+T+"'>"+k+"</text>",6==k&&(y+=e),y+=e;m+="</g>",m+="<g id='mid13to24' class='pointNumbers' font-size='"+pointNumberFontSize+"' text-anchor='middle' font-family='arial' fill='black'>";for(y=x,k=13;k<=24;k++)m+="<text x='"+y+"' y='"+T+"'>"+k+"</text>",18==k&&(y+=e),y+=e;m+="</g>",m+="<g id='mid12to1' class='pointNumbers' font-size='"+pointNumberFontSize+"' text-anchor='middle' font-family='arial' fill='black'>";for(y=x,k=12;1<=k;k--)m+="<text x='"+y+"' y='"+T+"'>"+k+"</text>",7==k&&(y+=e),y+=e;m+="</g>",m+="<g id='mid24to13' class='pointNumbers' font-size='"+pointNumberFontSize+"' text-anchor='middle' font-family='arial' fill='black'>";for(y=x,k=24;13<=k;k--)m+="<text x='"+y+"' y='"+T+"'>"+k+"</text>",19==k&&(y+=e),y+=e;m+="</g>",T=bottomY+pointNumberFontSize+borderWidth,m+="<g id='bot1to12' class='pointNumbers' font-size='"+pointNumberFontSize+"' text-anchor='middle' font-family='arial' fill='black'>";for(y=x,k=1;k<=12;k++)m+="<text x='"+y+"' y='"+T+"'>"+k+"</text>",6==k&&(y+=e),y+=e;m+="</g>",m+="<g id='bot13to24' class='pointNumbers' font-size='"+pointNumberFontSize+"' text-anchor='middle' font-family='arial' fill='black'>";for(y=x,k=13;k<=24;k++)m+="<text x='"+y+"' y='"+T+"'>"+k+"</text>",18==k&&(y+=e),y+=e;m+="</g>",m+="<g id='bot12to1' class='pointNumbers' font-size='"+pointNumberFontSize+"' text-anchor='middle' font-family='arial' fill='black'>";for(y=x,k=12;1<=k;k--)m+="<text x='"+y+"' y='"+T+"'>"+k+"</text>",7==k&&(y+=e),y+=e;m+="</g>",m+="<g id='bot24to13' class='pointNumbers' font-size='"+pointNumberFontSize+"' text-anchor='middle' font-family='arial' fill='black'>";for(y=x,k=24;13<=k;k--)m+="<text x='"+y+"' y='"+T+"'>"+k+"</text>",19==k&&(y+=e),y+=e;m+="</g>";var P=leftX+6.5*e-lineWidth;m+="<text id='oppPipcount' x='"+P+"' y='"+(pipCountFontSize-2*doubleLineWidth)+"' font-size='"+pipCountFontSize+"' text-anchor='middle' ></text>",m+="<text id='ourPipcount' x='"+P+"' y='"+(bottomY+pipCountFontSize+borderWidth-2*doubleLineWidth)+"' font-size='"+pipCountFontSize+"' text-anchor='middle'></text>";y=leftX-borderWidth-e/2;currentTheme.direction&&currentTheme.showTurnIndicator&&(y=rightX+borderWidth+e/2),m+="<text id='oppScoreText' x='"+y+"' y='"+(pipCountFontSize-2*doubleLineWidth)+"' font-size='"+pipCountFontSize+"' text-anchor='middle' ></text>",m+="<text id='ourScoreText' x='"+y+"' y='"+(bottomY+pipCountFontSize+borderWidth-2*doubleLineWidth)+"' font-size='"+pipCountFontSize+"' text-anchor='middle' ></text>";for(k=0;k<30;k++)m+="<g id='checker"+k+"' x='0' y='0'>",m+="<rect id='checkerCircle"+k+"' class='"+l+"' x='0' y='0'></rect>",m+="<text id='checkerText"+k+"' class='"+l+"text' x='"+(e/2-lineWidth)+"' y='"+e/3*2+"' text-anchor='middle' font-family='arial' font-size='"+e/2+"'></text>",m+="</g>",14==k&&(l="oppchecker");y=rightX+e+borderWidth+e/2;currentTheme.direction&&currentTheme.showTurnIndicator&&(y=leftX-e-borderWidth+e/2),m+="<circle id='ourTurnChecker' cx='"+y+"' cy='"+(bottomY+borderWidth+e/4)+"'></circle><circle id='oppTurnChecker' cx='"+y+"' cy='"+(e/4+lineWidth)+"'></circle>";for(k=0;k<maxCubes;k++)m+="<g id='cube"+k+"'class='cubes' x='"+s+"' y='"+d+"' style='visibility:hidden' ><rect x='0' y='0' width='"+cubeWidth+"' height='"+cubeWidth+"' rx='"+p+"'></rect><text id='cube"+k+"Text' class='cubeText' x='"+cubeWidth/2+"' y='"+c+"' text-anchor='middle'>64</text></g>";var v=g+c/4,S=v+c/4,w=S+c/4,z=b+c/4,W=z+c/4,F=W+c/4;m+="<g id='oppLeftDie' class='dice oppdice'><rect  x='"+g+"' y='"+b+"' width='"+c+"' height='"+c+"' rx='"+dicePipRadius+"' stroke='black' stroke-width='1'></rect><g><circle class='oppDicePips' id='oppLtlPip' cx='"+v+"' cy='"+z+"'></circle><circle class='oppDicePips' id='oppLtrPip' cx='"+w+"' cy='"+z+"'></circle><circle class='oppDicePips' id='oppLclPip' cx='"+v+"' cy='"+W+"'></circle><circle class='oppDicePips' id='oppLcPip' cx='"+S+"' cy='"+W+"'></circle><circle class='oppDicePips' id='oppLcrPip' cx='"+w+"' cy='"+W+"'></circle><circle class='oppDicePips' id='oppLblPip' cx='"+v+"' cy='"+F+"'></circle><circle class='oppDicePips' id='oppLbrPip' cx='"+w+"' cy='"+F+"'></circle></g></g>",v+=e,S+=e,w+=e,m+="<g id='oppRightDie' class='dice oppdice'><rect x='"+(g+=e)+"' y='"+b+"' width='"+c+"' height='"+c+"' rx='"+dicePipRadius+"' stroke='black' stroke-width='1'></rect><g class='dicePips'><circle class='oppDicePips' id='oppRtlPip' cx='"+v+"' cy='"+z+"'></circle><circle class='oppDicePips' id='oppRtrPip' cx='"+w+"' cy='"+z+"'></circle><circle class='oppDicePips' id='oppRclPip' cx='"+v+"' cy='"+W+"'></circle><circle class='oppDicePips' id='oppRcPip' cx='"+S+"' cy='"+W+"'></circle><circle class='oppDicePips' id='oppRcrPip' cx='"+w+"' cy='"+W+"'></circle><circle class='oppDicePips' id='oppRblPip' cx='"+v+"' cy='"+F+"'></circle><circle class='oppDicePips' id='oppRbrPip' cx='"+w+"' cy='"+F+"'></circle></g></g>",v+=6*e,S+=6*e,w+=6*e,m+="<g id='ourLeftDie' class='dice ourdice'><rect x='"+(g+=6*e)+"' y='"+b+"' width='"+c+"' height='"+c+"' rx='"+dicePipRadius+"' stroke='black' stroke-width='1'></rect><g><circle class='ourDicePips' id='ourLtlPip' cx='"+v+"' cy='"+z+"'></circle><circle class='ourDicePips' id='ourLtrPip' cx='"+w+"' cy='"+z+"'></circle><circle class='ourDicePips' id='ourLclPip' cx='"+v+"' cy='"+W+"'></circle><circle class='ourDicePips' id='ourLcPip' cx='"+S+"' cy='"+W+"'></circle><circle class='ourDicePips' id='ourLcrPip' cx='"+w+"' cy='"+W+"'></circle><circle class='ourDicePips' id='ourLblPip' cx='"+v+"' cy='"+F+"'></circle><circle class='ourDicePips' id='ourLbrPip' cx='"+w+"' cy='"+F+"'></circle></g></g>",v+=e,S+=e,w+=e,m+="<g id='ourRightDie' class='dice ourdice'><rect x='"+(g+=e)+"' y='"+b+"' width='"+c+"' height='"+c+"' rx='"+dicePipRadius+"' stroke='black' stroke-width='1'></rect><g class='dicePips'><circle class='ourDicePips' id='ourRtlPip' cx='"+v+"' cy='"+z+"'></circle><circle class='ourDicePips' id='ourRtrPip' cx='"+w+"' cy='"+z+"'></circle><circle class='ourDicePips' id='ourRclPip' cx='"+v+"' cy='"+W+"'></circle><circle class='ourDicePips' id='ourRcPip' cx='"+S+"' cy='"+W+"'></circle><circle class='ourDicePips' id='ourRcrPip' cx='"+w+"' cy='"+W+"'></circle><circle class='ourDicePips' id='ourRblPip' cx='"+v+"' cy='"+F+"'></circle><circle class='ourDicePips' id='ourRbrPip' cx='"+w+"' cy='"+F+"'></circle></g></g>",m+="<rect id='touch' x='0' y='0' width='"+r+"' height='"+o+"' fill='rgba(0,0,0,0)'></rect>",m+="</svg>",$("#bglogContainer").html(m),bglog.initCheckers()}};